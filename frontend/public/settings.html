<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/settings.css">
    <title>Settings</title>
</head>
<body>
    <main>
        <div id="container">
            <h1>SIEM Settings</h1>
            <nav>
                <a href="/">Dashboard</a>
                <a href="/settings">Settings</a>
                <a href="/alerts">All Alerts</a>
                <a href="/search">Search</a>
                <a href="/cases" class="active">Cases</a>
                <button id="logout-btn">Logout</button>
            </nav>

            <div id="alert-container"></div>

            <section class="agent-info">
                <div class="info-group">
                    <h3>Account ID</h3>
                    <div class="copy-container">
                        <span id="accountId"></span>
                        <button class="copy-btn" id="accountIdCopyBtn">Copy</button>
                    </div>
                </div>
                <div class="info-group">
                    <h3>Available Hosts</h3>
                    <table id="hostsTable">
                        <thead>
                            <tr>
                                <th>Host Name</th>
                                <th>Host ID</th>
                                <th>IP Address</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="hostsTableBody">
                        </tbody>
                    </table>
                </div>
            </section>

            <section>
                <h2>Upload Logs</h2>
                <form id="logForm">
                    <div>
                        <label for="logFile">Log File:</label>
                        <div id="input-spinner-container">
                            <input type="file" id="logFile" required>
                            <div class="spinner" id="loadingSpinner"></div>
                        </div>
                    </div>
                    <div>
                        <label for="hostSelect">Host:</label>
                        <select id="hostSelect" required>
                            <option value="" disabled selected></option>
                        </select>
                    </div>
                    <button type="submit">Upload</button>
                </form>
            </section>

            <section>
                <h2>Add New Host</h2>
                <form id="hostForm">
                    <div>
                        <label for="hostName">Host Name:</label>
                        <input type="text" id="hostName" required>
                    </div>
                    <div>
                        <label for="hostIP">IP Address:</label>
                        <input type="text" id="hostIP" required>
                    </div>
                    <button type="submit">Add Host</button>
                </form>
            </section>

            <section class="rule-form-container">
                <h2>Add New Rule</h2>
                <form id="ruleForm">
                    <div class="form-group">
                        <label for="title">Title:</label>
                        <input type="text" id="title" name="title" required>
                    </div>

                    <div class="form-group">
                        <label for="description">Description:</label>
                        <textarea id="description" name="description" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="status">Status:</label>
                        <select id="status" name="status" required>
                            <option value="experimental">Experimental</option>
                            <option value="stable">Stable</option>
                            <option value="deprecated">Deprecated</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="author">Author:</label>
                        <input type="text" id="author" name="author" required>
                    </div>

                    <div class="form-group">
                        <label for="tags">Tags (comma-separated):</label>
                        <input type="text" id="tags" name="tags" placeholder="attack.t1234, windows, persistence">
                    </div>

                    <div class="form-group">
                        <label for="references">References (comma-separated):</label>
                        <input type="text" id="references" name="references" placeholder="https://example.com, CVE-2023-1234">
                    </div>

                    <!-- Log Source -->
                    <div class="form-group">
                        <label for="logsource_category">Log Source Category:</label>
                        <input type="text" id="logsource_category" name="logsource_category">
                    </div>

                    <div class="form-group">
                        <label for="logsource_product">Log Source Product:</label>
                        <input type="text" id="logsource_product" name="logsource_product">
                    </div>

                    <div class="form-group">
                        <label for="logsource_service">Log Source Service:</label>
                        <input type="text" id="logsource_service" name="logsource_service">
                    </div>

                    <div class="form-group">
                        <label for="detection_selection_field">Selection Field:</label>
                        <input type="text" id="detection_selection_field" name="detection_selection_field" required 
                               placeholder="field name (e.g., msg, level)">
                    </div>

                    <div class="form-group">
                        <label for="detection_selection_value">Selection Value:</label>
                        <input type="text" id="detection_selection_value" name="detection_selection_value" required 
                               placeholder="field value (e.g., 'No token provided')">
                    </div>

                    <div class="form-group">
                        <label for="detection_condition">Detection Condition:</label>
                        <input type="text" id="detection_condition" name="detection_condition" required 
                               placeholder="condition (e.g., selection)" value="selection">
                    </div>

                    <div class="form-group">
                        <label for="fields">Fields (comma-separated):</label>
                        <input type="text" id="fields" name="fields" placeholder="EventID, CommandLine, ProcessName">
                    </div>

                    <div class="form-group">
                        <label for="falsepositives">False Positives (comma-separated):</label>
                        <input type="text" id="falsepositives" name="falsepositives">
                    </div>

                    <div class="form-group">
                        <label for="level">Level:</label>
                        <select id="level" name="level" required>
                            <option value="Informational">Informational</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                            <option value="Critical">Critical</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="enabled">Enabled:</label>
                        <input type="checkbox" id="enabled" name="enabled" checked>
                    </div>

                    <button type="submit">Create Rule</button>
                </form>
            </section>
        </div>
    </main>
    <script type="module" src="/js/settings.js"></script>
</body>
</html>